<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Lua_api_lib (ocaml-lua.Lua_api_lib)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">ocaml-lua</a> &#x00BB; Lua_api_lib</nav><h1>Module <code>Lua_api_lib</code></h1><h2 id="the-lua-application-program-interface-(ocaml-binding)"><a href="#the-lua-application-program-interface-(ocaml-binding)" class="anchor"></a>The Lua Application Program Interface (OCaml binding)</h2><nav class="toc"><ul><li><a href="#difference-with-the-original-lua-api">Difference with the original Lua API</a></li><li><a href="#types-definitions">Types definitions</a></li><li><a href="#constant-values">Constant values</a></li><li><a href="#exceptions">Exceptions</a></li><li><a href="#functions-not-present-in-the-lua-api">Functions not present in the Lua API</a></li><li><a href="#lua-api-functions">Lua API functions</a></li></ul></nav></header><section><header><h3 id="difference-with-the-original-lua-api"><a href="#difference-with-the-original-lua-api" class="anchor"></a>Difference with the original Lua API</h3></header><aside><p>Here is a list of functions of which you should read documentation:</p><ul><li><b>Missing functions</b>: <code>lua_close</code>, <code>lua_getallocf</code>, <code>lua_newstate</code> (see below <a href="#VALload">here</a>), <code>lua_pushcclosure</code> (see below <a href="#VALpushboolean">here</a>), <code>lua_setallocf</code>, <code>lua_topointer</code>.</li><li><b>Notably different functions</b>: <a href="index.html#val-newuserdata"><code>newuserdata</code></a>, <a href="index.html#val-pushfstring"><code>pushfstring</code></a>, <a href="index.html#val-pushlightuserdata"><code>pushlightuserdata</code></a>, <a href="index.html#val-touserdata"><code>touserdata</code></a></li><li><b>Special remarks</b>: <a href="index.html#val-cpcall"><code>cpcall</code></a>, <a href="index.html#val-newthread"><code>newthread</code></a>, <a href="index.html#val-default_gc"><code>default_gc</code></a>, <a href="index.html#val-make_gc_function"><code>make_gc_function</code></a>. <a href="index.html#val-tolstring"><code>tolstring</code></a></li></ul></aside></section><section><header><h3 id="types-definitions"><a href="#types-definitions" class="anchor"></a>Types definitions</h3></header><dl><dt class="spec type" id="type-state"><a href="#type-state" class="anchor"></a><code><span class="keyword">type</span> state</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_State">lua_State</a> documentation.</p></dd></dl><dl><dt class="spec type" id="type-oCamlFunction"><a href="#type-oCamlFunction" class="anchor"></a><code><span class="keyword">type</span> oCamlFunction</code><code> = <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int</code></dt><dd><p>This type corresponds to lua_CFunction. See <a href="http://www.lua.org/manual/5.1/manual.html#lua_CFunction">lua_CFunction</a> documentation.</p></dd></dl><dl><dt class="spec type" id="type-thread_status"><a href="#type-thread_status" class="anchor"></a><code><span class="keyword">type</span> thread_status</code><code> = </code><table class="variant"><tr id="type-thread_status.LUA_OK" class="anchored"><td class="def constructor"><a href="#type-thread_status.LUA_OK" class="anchor"></a><code>| </code><code><span class="constructor">LUA_OK</span></code></td></tr><tr id="type-thread_status.LUA_YIELD" class="anchored"><td class="def constructor"><a href="#type-thread_status.LUA_YIELD" class="anchor"></a><code>| </code><code><span class="constructor">LUA_YIELD</span></code></td></tr><tr id="type-thread_status.LUA_ERRRUN" class="anchored"><td class="def constructor"><a href="#type-thread_status.LUA_ERRRUN" class="anchor"></a><code>| </code><code><span class="constructor">LUA_ERRRUN</span></code></td></tr><tr id="type-thread_status.LUA_ERRSYNTAX" class="anchored"><td class="def constructor"><a href="#type-thread_status.LUA_ERRSYNTAX" class="anchor"></a><code>| </code><code><span class="constructor">LUA_ERRSYNTAX</span></code></td></tr><tr id="type-thread_status.LUA_ERRMEM" class="anchored"><td class="def constructor"><a href="#type-thread_status.LUA_ERRMEM" class="anchor"></a><code>| </code><code><span class="constructor">LUA_ERRMEM</span></code></td></tr><tr id="type-thread_status.LUA_ERRERR" class="anchored"><td class="def constructor"><a href="#type-thread_status.LUA_ERRERR" class="anchor"></a><code>| </code><code><span class="constructor">LUA_ERRERR</span></code></td></tr><tr id="type-thread_status.LUA_ERRFILE" class="anchored"><td class="def constructor"><a href="#type-thread_status.LUA_ERRFILE" class="anchor"></a><code>| </code><code><span class="constructor">LUA_ERRFILE</span></code></td></tr></table></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#pdf-LUA_YIELD">lua_status</a> documentation.</p></dd></dl><dl><dt class="spec type" id="type-gc_command"><a href="#type-gc_command" class="anchor"></a><code><span class="keyword">type</span> gc_command</code><code> = </code><table class="variant"><tr id="type-gc_command.GCSTOP" class="anchored"><td class="def constructor"><a href="#type-gc_command.GCSTOP" class="anchor"></a><code>| </code><code><span class="constructor">GCSTOP</span></code></td></tr><tr id="type-gc_command.GCRESTART" class="anchored"><td class="def constructor"><a href="#type-gc_command.GCRESTART" class="anchor"></a><code>| </code><code><span class="constructor">GCRESTART</span></code></td></tr><tr id="type-gc_command.GCCOLLECT" class="anchored"><td class="def constructor"><a href="#type-gc_command.GCCOLLECT" class="anchor"></a><code>| </code><code><span class="constructor">GCCOLLECT</span></code></td></tr><tr id="type-gc_command.GCCOUNT" class="anchored"><td class="def constructor"><a href="#type-gc_command.GCCOUNT" class="anchor"></a><code>| </code><code><span class="constructor">GCCOUNT</span></code></td></tr><tr id="type-gc_command.GCCOUNTB" class="anchored"><td class="def constructor"><a href="#type-gc_command.GCCOUNTB" class="anchor"></a><code>| </code><code><span class="constructor">GCCOUNTB</span></code></td></tr><tr id="type-gc_command.GCSTEP" class="anchored"><td class="def constructor"><a href="#type-gc_command.GCSTEP" class="anchor"></a><code>| </code><code><span class="constructor">GCSTEP</span></code></td></tr><tr id="type-gc_command.GCSETPAUSE" class="anchored"><td class="def constructor"><a href="#type-gc_command.GCSETPAUSE" class="anchor"></a><code>| </code><code><span class="constructor">GCSETPAUSE</span></code></td></tr><tr id="type-gc_command.GCSETSTEPMUL" class="anchored"><td class="def constructor"><a href="#type-gc_command.GCSETSTEPMUL" class="anchor"></a><code>| </code><code><span class="constructor">GCSETSTEPMUL</span></code></td></tr></table></dt><dd><p>This type is not present in the official API and is used by the function <code>gc</code></p></dd></dl><dl><dt class="spec type" id="type-lua_type"><a href="#type-lua_type" class="anchor"></a><code><span class="keyword">type</span> lua_type</code><code> = </code><table class="variant"><tr id="type-lua_type.LUA_TNONE" class="anchored"><td class="def constructor"><a href="#type-lua_type.LUA_TNONE" class="anchor"></a><code>| </code><code><span class="constructor">LUA_TNONE</span></code></td></tr><tr id="type-lua_type.LUA_TNIL" class="anchored"><td class="def constructor"><a href="#type-lua_type.LUA_TNIL" class="anchor"></a><code>| </code><code><span class="constructor">LUA_TNIL</span></code></td></tr><tr id="type-lua_type.LUA_TBOOLEAN" class="anchored"><td class="def constructor"><a href="#type-lua_type.LUA_TBOOLEAN" class="anchor"></a><code>| </code><code><span class="constructor">LUA_TBOOLEAN</span></code></td></tr><tr id="type-lua_type.LUA_TLIGHTUSERDATA" class="anchored"><td class="def constructor"><a href="#type-lua_type.LUA_TLIGHTUSERDATA" class="anchor"></a><code>| </code><code><span class="constructor">LUA_TLIGHTUSERDATA</span></code></td></tr><tr id="type-lua_type.LUA_TNUMBER" class="anchored"><td class="def constructor"><a href="#type-lua_type.LUA_TNUMBER" class="anchor"></a><code>| </code><code><span class="constructor">LUA_TNUMBER</span></code></td></tr><tr id="type-lua_type.LUA_TSTRING" class="anchored"><td class="def constructor"><a href="#type-lua_type.LUA_TSTRING" class="anchor"></a><code>| </code><code><span class="constructor">LUA_TSTRING</span></code></td></tr><tr id="type-lua_type.LUA_TTABLE" class="anchored"><td class="def constructor"><a href="#type-lua_type.LUA_TTABLE" class="anchor"></a><code>| </code><code><span class="constructor">LUA_TTABLE</span></code></td></tr><tr id="type-lua_type.LUA_TFUNCTION" class="anchored"><td class="def constructor"><a href="#type-lua_type.LUA_TFUNCTION" class="anchor"></a><code>| </code><code><span class="constructor">LUA_TFUNCTION</span></code></td></tr><tr id="type-lua_type.LUA_TUSERDATA" class="anchored"><td class="def constructor"><a href="#type-lua_type.LUA_TUSERDATA" class="anchor"></a><code>| </code><code><span class="constructor">LUA_TUSERDATA</span></code></td></tr><tr id="type-lua_type.LUA_TTHREAD" class="anchored"><td class="def constructor"><a href="#type-lua_type.LUA_TTHREAD" class="anchor"></a><code>| </code><code><span class="constructor">LUA_TTHREAD</span></code></td></tr></table></dt><dd><p>This type is a collection of the possible types of a Lua value, as defined by the macros in lua.h. As a reference, see the documentation of the <a href="http://www.lua.org/manual/5.1/manual.html#lua_type">lua_type function</a>, and the corresponding OCaml <a href="index.html#val-type_"><code>Lua_api_lib.type_</code></a>.</p></dd></dl><dl><dt class="spec type" id="type-lua_Reader"><a href="#type-lua_Reader" class="anchor"></a><code><span class="keyword">type</span> <span>'a lua_Reader</span></code><code> = <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_Reader">lua_Reader</a> documentation.</p></dd></dl><dl><dt class="spec type" id="type-writer_status"><a href="#type-writer_status" class="anchor"></a><code><span class="keyword">type</span> writer_status</code><code> = </code><table class="variant"><tr id="type-writer_status.NO_WRITING_ERROR" class="anchored"><td class="def constructor"><a href="#type-writer_status.NO_WRITING_ERROR" class="anchor"></a><code>| </code><code><span class="constructor">NO_WRITING_ERROR</span></code></td><td class="doc"><p>No errors, go on writing</p></td></tr><tr id="type-writer_status.WRITING_ERROR" class="anchored"><td class="def constructor"><a href="#type-writer_status.WRITING_ERROR" class="anchor"></a><code>| </code><code><span class="constructor">WRITING_ERROR</span></code></td><td class="doc"><p>An error occurred, stop writing</p></td></tr></table></dt><dt class="spec type" id="type-lua_Writer"><a href="#type-lua_Writer" class="anchor"></a><code><span class="keyword">type</span> <span>'a lua_Writer</span></code><code> = <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <a href="index.html#type-writer_status">writer_status</a></code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_Writer">lua_Writer</a> documentation.</p></dd></dl></section><section><header><h3 id="constant-values"><a href="#constant-values" class="anchor"></a>Constant values</h3></header><dl><dt class="spec value" id="val-multret"><a href="#val-multret" class="anchor"></a><code><span class="keyword">val</span> multret : int</code></dt><dd><p>Option for multiple returns in `Lua.pcall' and `Lua.call'. See <a href="http://www.lua.org/manual/5.1/manual.html#lua_call">lua_call</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-registryindex"><a href="#val-registryindex" class="anchor"></a><code><span class="keyword">val</span> registryindex : int</code></dt><dd><p>Pseudo-index to access the registry. See <a href="http://www.lua.org/manual/5.1/manual.html#3.5">Registry</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-environindex"><a href="#val-environindex" class="anchor"></a><code><span class="keyword">val</span> environindex : int</code></dt><dd><p>Pseudo-index to access the environment of the running C function. See <a href="http://www.lua.org/manual/5.1/manual.html#3.3">Registry</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-globalsindex"><a href="#val-globalsindex" class="anchor"></a><code><span class="keyword">val</span> globalsindex : int</code></dt><dd><p>Pseudo-index to access the thread environment (where global variables live). See <a href="http://www.lua.org/manual/5.1/manual.html#3.3">Registry</a> documentation.</p></dd></dl></section><section><header><h3 id="exceptions"><a href="#exceptions" class="anchor"></a>Exceptions</h3></header><dl><dt class="spec exception" id="exception-Error"><a href="#exception-Error" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Error</span> <span class="keyword">of</span> <a href="index.html#type-thread_status">thread_status</a></code></dt><dt class="spec exception" id="exception-Type_error"><a href="#exception-Type_error" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Type_error</span> <span class="keyword">of</span> string</code></dt></dl></section><section><header><h3 id="functions-not-present-in-the-lua-api"><a href="#functions-not-present-in-the-lua-api" class="anchor"></a>Functions not present in the Lua API</h3></header><dl><dt class="spec value" id="val-thread_status_of_int"><a href="#val-thread_status_of_int" class="anchor"></a><code><span class="keyword">val</span> thread_status_of_int : int <span>&#45;&gt;</span> <a href="index.html#type-thread_status">thread_status</a></code></dt><dd><p>Convert an integer into a <code>thread_status</code>. Raises <code>failure</code> on invalid parameter.</p></dd></dl><dl><dt class="spec value" id="val-int_of_thread_status"><a href="#val-int_of_thread_status" class="anchor"></a><code><span class="keyword">val</span> int_of_thread_status : <a href="index.html#type-thread_status">thread_status</a> <span>&#45;&gt;</span> int</code></dt><dd><p>Convert a <code>thread_status</code> into an integer.</p></dd></dl><dl><dt class="spec value" id="val-lua_type_of_int"><a href="#val-lua_type_of_int" class="anchor"></a><code><span class="keyword">val</span> lua_type_of_int : int <span>&#45;&gt;</span> <a href="index.html#type-lua_type">lua_type</a></code></dt><dd><p>Convert an integer into a <code>lua_type</code>. Raises <code>failure</code> on invalid parameter.</p></dd></dl><dl><dt class="spec value" id="val-int_of_lua_type"><a href="#val-int_of_lua_type" class="anchor"></a><code><span class="keyword">val</span> int_of_lua_type : <a href="index.html#type-lua_type">lua_type</a> <span>&#45;&gt;</span> int</code></dt><dd><p>Convert a <code>lua_type</code> into an integer.</p></dd></dl></section><section><header><h3 id="lua-api-functions"><a href="#lua-api-functions" class="anchor"></a>Lua API functions</h3></header><dl><dt class="spec external" id="val-atpanic"><a href="#val-atpanic" class="anchor"></a><code><span class="keyword">val</span> atpanic : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-oCamlFunction">oCamlFunction</a> <span>&#45;&gt;</span> <a href="index.html#type-oCamlFunction">oCamlFunction</a></code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_atpanic">lua_atpanic</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-call"><a href="#val-call" class="anchor"></a><code><span class="keyword">val</span> call : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_call">lua_call</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-checkstack"><a href="#val-checkstack" class="anchor"></a><code><span class="keyword">val</span> checkstack : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_checkstack">lua_checkstack</a> documentation.</p></dd></dl><aside><p>The function <a href="http://www.lua.org/manual/5.1/manual.html#lua_close">lua_close</a> is not present because all the data structures of a Lua state are managed by the OCaml garbage collector.</p></aside><dl><dt class="spec external" id="val-concat"><a href="#val-concat" class="anchor"></a><code><span class="keyword">val</span> concat : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_concat">lua_concat</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-cpcall"><a href="#val-cpcall" class="anchor"></a><code><span class="keyword">val</span> cpcall : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-oCamlFunction">oCamlFunction</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <a href="index.html#type-thread_status">thread_status</a></code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_cpcall">lua_cpcall</a> documentation.</p><p><b>NOTE</b>: this function is <b>not</b> a binding of the original lua_cpcall, it's rather an OCaml function with the same semantics.</p><p><b>WARNING</b>: the OCaml function you want to execute in a protected environment is actually protected againt <b>Lua</b> errors, even memory errors, but <b>not</b> against OCaml errors, i.e. exceptions. If for example you run:</p><pre><code class="ml">let ls = LuaL.newstate ();;
let my_func ls = failwith &quot;Sorry, my fault...&quot;; 0;;
let cpcall_result = Lua.cpcall ls my_func 42;;</code></pre><p>cpcall <b>will actually raise</b> a failure, because that exception is not generated by Lua but by OCaml.</p></dd></dl><dl><dt class="spec external" id="val-createtable"><a href="#val-createtable" class="anchor"></a><code><span class="keyword">val</span> createtable : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_createtable">lua_createtable</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-dump"><a href="#val-dump" class="anchor"></a><code><span class="keyword">val</span> dump : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-lua_Writer">lua_Writer</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <a href="index.html#type-writer_status">writer_status</a></code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_dump">lua_dump</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val</span> equal : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_equal">lua_equal</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-error"><a href="#val-error" class="anchor"></a><code><span class="keyword">val</span> error : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_error">lua_error</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-gc"><a href="#val-gc" class="anchor"></a><code><span class="keyword">val</span> gc : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-gc_command">gc_command</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_gc">lua_gc</a> documentation.</p></dd></dl><aside><p><a href="http://www.lua.org/manual/5.1/manual.html#lua_getallocf">lua_getallocf</a> not implemented in this binding</p></aside><dl><dt class="spec external" id="val-getfenv"><a href="#val-getfenv" class="anchor"></a><code><span class="keyword">val</span> getfenv : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_getfenv">lua_getfenv</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-getfield"><a href="#val-getfield" class="anchor"></a><code><span class="keyword">val</span> getfield : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_getfield">lua_getfield</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-getglobal"><a href="#val-getglobal" class="anchor"></a><code><span class="keyword">val</span> getglobal : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_getglobal">lua_getglobal</a> documentation. Like in the original Lua source code this function is implemented in OCaml using <code>getfield</code>.</p></dd></dl><dl><dt class="spec external" id="val-getmetatable"><a href="#val-getmetatable" class="anchor"></a><code><span class="keyword">val</span> getmetatable : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_getmetatable">lua_getmetatable</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-gettable"><a href="#val-gettable" class="anchor"></a><code><span class="keyword">val</span> gettable : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_gettable">lua_gettable</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-gettop"><a href="#val-gettop" class="anchor"></a><code><span class="keyword">val</span> gettop : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_gettop">lua_gettop</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-insert"><a href="#val-insert" class="anchor"></a><code><span class="keyword">val</span> insert : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_insert">lua_insert</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-isboolean"><a href="#val-isboolean" class="anchor"></a><code><span class="keyword">val</span> isboolean : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_isboolean">lua_isboolean</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-iscfunction"><a href="#val-iscfunction" class="anchor"></a><code><span class="keyword">val</span> iscfunction : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_iscfunction">lua_iscfunction</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-isfunction"><a href="#val-isfunction" class="anchor"></a><code><span class="keyword">val</span> isfunction : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_isfunction">lua_isfunction</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-islightuserdata"><a href="#val-islightuserdata" class="anchor"></a><code><span class="keyword">val</span> islightuserdata : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_islightuserdata">lua_islightuserdata</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-isnil"><a href="#val-isnil" class="anchor"></a><code><span class="keyword">val</span> isnil : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_isnil">lua_isnil</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-isnone"><a href="#val-isnone" class="anchor"></a><code><span class="keyword">val</span> isnone : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_isnone">lua_isnone</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-isnoneornil"><a href="#val-isnoneornil" class="anchor"></a><code><span class="keyword">val</span> isnoneornil : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_isnoneornil">lua_isnoneornil</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-isnumber"><a href="#val-isnumber" class="anchor"></a><code><span class="keyword">val</span> isnumber : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_isnumber">lua_isnumber</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-isstring"><a href="#val-isstring" class="anchor"></a><code><span class="keyword">val</span> isstring : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_isstring">lua_isstring</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-istable"><a href="#val-istable" class="anchor"></a><code><span class="keyword">val</span> istable : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_istable">lua_istable</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-isthread"><a href="#val-isthread" class="anchor"></a><code><span class="keyword">val</span> isthread : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_isthread">lua_isthread</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-isuserdata"><a href="#val-isuserdata" class="anchor"></a><code><span class="keyword">val</span> isuserdata : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_isuserdata">lua_isuserdata</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-lessthan"><a href="#val-lessthan" class="anchor"></a><code><span class="keyword">val</span> lessthan : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_lessthan">lua_lessthan</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-load"><a href="#val-load" class="anchor"></a><code><span class="keyword">val</span> load : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-lua_Reader">lua_Reader</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-thread_status">thread_status</a></code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_load">lua_load</a> documentation.</p></dd></dl><aside><p>The function <a href="http://www.lua.org/manual/5.1/manual.html#lua_newstate">lua_newstate</a> is not present because it makes very little sense to specify a custom allocator written in OCaml. To create a new Lua state, use the function <a href="../Lua_aux_lib/index.html#val-newstate"><code>Lua_aux_lib.newstate</code></a>.</p></aside><dl><dt class="spec external" id="val-newtable"><a href="#val-newtable" class="anchor"></a><code><span class="keyword">val</span> newtable : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_newtable">lua_newtable</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-newthread"><a href="#val-newthread" class="anchor"></a><code><span class="keyword">val</span> newthread : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a></code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_newthread">lua_newthread</a> documentation.</p><p>When you create a new thread, this binding guaranties that the Lua object will remain &quot;living&quot; (protected from both the Lua and the OCaml garbage collectors) until a valid copy exists in at least one of the two contexts.</p><p>Remember that all the threads obtained by <code>newthread</code> and <a href="index.html#val-tothread"><code>Lua_api_lib.tothread</code></a> are shared copies, for example:</p><pre><code class="ml">let state = LuaL.newstate ();;
let th = Lua.newthread state;;
let th' = match Lua.tothread state 1 with Some s -&gt; s | None -&gt; failwith &quot;not an option!&quot;;;
Lua.settop state 0;;</code></pre><p>Now the stack of <code>state</code> is empty and you have two threads, <code>th</code> and <code>th'</code>, but they are actually the <em>very same data structure</em> and operations performed on the first will be visible on the second!</p><p>Another important issue regarding the scope of a state object representing a thread (coroutine): this binding don't prevent you from accessing invalid memory in case of misuse of the library. Please, carefully consider this fragment:</p><pre><code class="ml">let f () =
  let state = LuaL.newstate () in
  let th = Lua.newthread state in
  th;;

let th' = f ();;
Gc.compact ();; (* This will collect [state] inside [f] *)
(* Here something using [th'] *)</code></pre><p>After <code>Gc.compact</code> the value inside <code>th'</code> has lost any possible meaning, because it's a thread (a coroutine) of a state object that has been already collected. Using <code>th'</code> will lead to a <em>segmentation fault</em>, at best, and to an <em>undefined behaviour</em> if you are unlucky.</p></dd></dl><dl><dt class="spec external" id="val-default_gc"><a href="#val-default_gc" class="anchor"></a><code><span class="keyword">val</span> default_gc : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int</code></dt><dd><p>This is the default &quot;__gc&quot; function attached to any new userdatum created with <code>newuserdata</code>. See documentation of <a href="index.html#val-newuserdata"><code>newuserdata</code></a> below.</p></dd></dl><dl><dt class="spec value" id="val-make_gc_function"><a href="#val-make_gc_function" class="anchor"></a><code><span class="keyword">val</span> make_gc_function : <a href="index.html#type-oCamlFunction">oCamlFunction</a> <span>&#45;&gt;</span> <a href="index.html#type-oCamlFunction">oCamlFunction</a></code></dt><dd><p>This function takes an <a href="index.html#type-oCamlFunction"><code>oCamlFunction</code></a> you have created to be executed as &quot;__gc&quot; metamethod and &quot;decorates&quot; it with some default actions needed to deallocate all the memory.</p><p>If you want to create a &quot;__gc&quot; method for your userdata, you <b>must</b> register the value from <code>make_gc_function</code>.</p></dd></dl><dl><dt class="spec external" id="val-newuserdata"><a href="#val-newuserdata" class="anchor"></a><code><span class="keyword">val</span> newuserdata : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>newuserdata</code> is the binding of <a href="http://www.lua.org/manual/5.1/manual.html#lua_newuserdata">lua_newuserdata</a> but it works in a different way if compared to the original function, and the signature is slightly different.</p><p>In C <code>lua_newuserdata</code> allocates an area for you, returns a <code>void*</code> and you cast it as needed. Moreover, it pushes the new userdata on the stack.</p><p>In OCaml, however, you never allocates a value and so the resulting signature provides you a way to push an already created value on the top of the Lua stack.</p><p><b>Very important remark, read carefully.</b> The original Lua <code>lua_newuserdata</code> doesn't associate to the new userdatum any metatable, it's up to you to define a metatable with metamethods, if you need it. On the other hand, this binding <b>silently</b> creates a metatable with only one metamethod (&quot;__gc&quot;) and associates the function <a href="index.html#val-default_gc"><code>default_gc</code></a> defined above. This function takes care of managing the memory between the two garbage collectors when needed. This is transparent to you, unless you want to attach to the userdatum a metatable of your, which is very likely to happen.</p><p>In case you want to attach a metatable to your userdatum you <b>must</b> include the &quot;__gc&quot; metamethod, and you <b>must</b> create the function using <a href="index.html#val-make_gc_function"><code>make_gc_function</code></a> described above.If you want a metatable for your userdatum but you don't need a &quot;__gc&quot;, use in any case the <a href="index.html#val-default_gc"><code>default_gc</code></a>. <b>Don't create a userdatum with a metatable and without &quot;__gc&quot; or your program will leak memory!</b></p><p><b>WARNING</b>: using this function could be harmful because it actually breaks the type system. It has the same semantics of <code>Obj.magic</code>, allowing the programmer to push an OCaml value into the Lua state, and then retrieve it with a different type. Be very careful!</p></dd></dl><dl><dt class="spec external" id="val-next"><a href="#val-next" class="anchor"></a><code><span class="keyword">val</span> next : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_next">lua_next</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-objlen"><a href="#val-objlen" class="anchor"></a><code><span class="keyword">val</span> objlen : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_objlen">lua_objlen</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-pcall"><a href="#val-pcall" class="anchor"></a><code><span class="keyword">val</span> pcall : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-thread_status">thread_status</a></code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_pcall">lua_pcall</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-pop"><a href="#val-pop" class="anchor"></a><code><span class="keyword">val</span> pop : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_pop">lua_pop</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-pushboolean"><a href="#val-pushboolean" class="anchor"></a><code><span class="keyword">val</span> pushboolean : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> bool <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_pushboolean">lua_pushboolean</a> documentation.</p></dd></dl><aside><p>The function <a href="http://www.lua.org/manual/5.1/manual.html#lua_pushcclosure">lua_pushcclosure</a> is not present because it makes very little sense to specify a &quot;closure&quot; written in OCaml, using the Lua <a href="http://www.lua.org/pil/27.3.3.html">upvalues</a> machinery. Use instead <a href="index.html#val-pushcfunction"><code>Lua_api_lib.pushcfunction</code></a></p></aside><dl><dt class="spec external" id="val-pushcfunction"><a href="#val-pushcfunction" class="anchor"></a><code><span class="keyword">val</span> pushcfunction : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-oCamlFunction">oCamlFunction</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_pushcfunction">lua_pushcfunction</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-pushocamlfunction"><a href="#val-pushocamlfunction" class="anchor"></a><code><span class="keyword">val</span> pushocamlfunction : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-oCamlFunction">oCamlFunction</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Alias of <a href="index.html#val-pushcfunction"><code>Lua_api_lib.pushcfunction</code></a></p></dd></dl><dl><dt class="spec value" id="val-pushfstring"><a href="#val-pushfstring" class="anchor"></a><code><span class="keyword">val</span> pushfstring : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, string)</span> Stdlib.format4</span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Pushes onto the stack a formatted string and returns the string itself. It is similar to the standard library function sprintf.</p><p>Warning: this function has a different behavior with respect to the original <a href="http://www.lua.org/manual/5.1/manual.html#lua_pushfstring">lua_pushfstring</a> because the conversion specifiers are not restricted as specified in the Lua documentation, but you can use all the conversions of the <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Printf.html">Printf module</a>.</p></dd></dl><dl><dt class="spec external" id="val-pushinteger"><a href="#val-pushinteger" class="anchor"></a><code><span class="keyword">val</span> pushinteger : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_pushinteger">lua_pushinteger</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-pushlightuserdata"><a href="#val-pushlightuserdata" class="anchor"></a><code><span class="keyword">val</span> pushlightuserdata : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_pushlightuserdata">lua_pushlightuserdata</a> documentation. Raises <code>Not_a_block_value</code> if you try to push a non-block value (e.g. an immediate integer) as a light userdata.</p><p>In Lua a light userdata is a way to store inside the Lua state a C pointer. It's up the programmer to carefully check for the lifetime of the data structures passed to Lua via a light userdata. If you malloc a pointer and pass it to Lua, then you free it from C and then you retrieve the same pointer from Lua (using lua_touserdata), you are most probably shooting yourself in the foot.</p><p>To avoid this class of problems I decided to implement some logic in the binding of this function. When you push an OCaml value as a Lua light userdata, a global reference to that (OCaml) value is kept inside the Lua state L. So, if the original value goes out of scope it is <em>not</em> collected by the garbage collector. In this scenario:</p><pre><code class="ml">let push_something state =
  let ocaml_value = get_some_complex_value () in
  pushlightuserdata state ocaml_value;
  state
;;</code></pre><p>when the <code>push_something</code> function returns the Lua state, the <code>ocaml_value</code> is <em>not</em> collected and can be retrieved at a later time from <code>state</code>.</p><p>This behaviour has a major drawback: while ensuring the lifetime of objects, it wastes memory. All the OCaml values pushed as light userdata will in fact be collected when the garbage collector decide to collect the Lua state itself. This means that if you have a long running task (e.g. a server) with a Lua state and you use <code>pushlightuserdata</code>, the values pushed will be <em>never</em> collected!</p><p>Moreover, if you push a value that have some resources associated with it (e.g. a channel, a socket or a DB handler) the resources will be released only when the Lua state goes out of scope.</p></dd></dl><dl><dt class="spec external" id="val-pushliteral"><a href="#val-pushliteral" class="anchor"></a><code><span class="keyword">val</span> pushliteral : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_pushliteral">lua_pushliteral</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-pushlstring"><a href="#val-pushlstring" class="anchor"></a><code><span class="keyword">val</span> pushlstring : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_pushlstring">lua_pushlstring</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-pushnil"><a href="#val-pushnil" class="anchor"></a><code><span class="keyword">val</span> pushnil : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_pushnil">lua_pushnil</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-pushnumber"><a href="#val-pushnumber" class="anchor"></a><code><span class="keyword">val</span> pushnumber : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> float <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_pushnumber">lua_pushnumber</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-pushstring"><a href="#val-pushstring" class="anchor"></a><code><span class="keyword">val</span> pushstring : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_pushstring">lua_pushstring</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-pushthread"><a href="#val-pushthread" class="anchor"></a><code><span class="keyword">val</span> pushthread : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_pushthread">lua_pushthread</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-pushvalue"><a href="#val-pushvalue" class="anchor"></a><code><span class="keyword">val</span> pushvalue : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_pushvalue">lua_pushvalue</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-pushvfstring"><a href="#val-pushvfstring" class="anchor"></a><code><span class="keyword">val</span> pushvfstring : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, unit, string, string)</span> Stdlib.format4</span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Alias of <a href="index.html#val-pushfstring"><code>Lua_api_lib.pushfstring</code></a></p></dd></dl><dl><dt class="spec external" id="val-rawequal"><a href="#val-rawequal" class="anchor"></a><code><span class="keyword">val</span> rawequal : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_rawequal">lua_rawequal</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-rawget"><a href="#val-rawget" class="anchor"></a><code><span class="keyword">val</span> rawget : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_rawget">lua_rawget</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-rawgeti"><a href="#val-rawgeti" class="anchor"></a><code><span class="keyword">val</span> rawgeti : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_rawgeti">lua_rawgeti</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-rawset"><a href="#val-rawset" class="anchor"></a><code><span class="keyword">val</span> rawset : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_rawset">lua_rawset</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-rawseti"><a href="#val-rawseti" class="anchor"></a><code><span class="keyword">val</span> rawseti : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_rawseti">lua_rawseti</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-register"><a href="#val-register" class="anchor"></a><code><span class="keyword">val</span> register : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-oCamlFunction">oCamlFunction</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_register">lua_register</a> documentation. The function is implemented in OCaml using pushcfunction and setglobal.</p></dd></dl><dl><dt class="spec external" id="val-remove"><a href="#val-remove" class="anchor"></a><code><span class="keyword">val</span> remove : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_remove">lua_remove</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-replace"><a href="#val-replace" class="anchor"></a><code><span class="keyword">val</span> replace : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_replace">lua_replace</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-resume"><a href="#val-resume" class="anchor"></a><code><span class="keyword">val</span> resume : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-thread_status">thread_status</a></code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_resume">lua_resume</a> documentation.</p></dd></dl><aside><p><a href="http://www.lua.org/manual/5.1/manual.html#lua_setallocf">lua_setallocf</a> not implemented in this binding</p></aside><dl><dt class="spec external" id="val-setfenv"><a href="#val-setfenv" class="anchor"></a><code><span class="keyword">val</span> setfenv : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_setfenv">lua_setfenv</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-setfield"><a href="#val-setfield" class="anchor"></a><code><span class="keyword">val</span> setfield : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_setfield">lua_setfield</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-setglobal"><a href="#val-setglobal" class="anchor"></a><code><span class="keyword">val</span> setglobal : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_setglobal">lua_setglobal</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-setmetatable"><a href="#val-setmetatable" class="anchor"></a><code><span class="keyword">val</span> setmetatable : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_setmetatable">lua_setmetatable</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-settable"><a href="#val-settable" class="anchor"></a><code><span class="keyword">val</span> settable : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_settable">lua_settable</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-settop"><a href="#val-settop" class="anchor"></a><code><span class="keyword">val</span> settop : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_settop">lua_settop</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-status"><a href="#val-status" class="anchor"></a><code><span class="keyword">val</span> status : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-thread_status">thread_status</a></code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_status">lua_status</a> documentation.</p></dd></dl><dl><dt class="spec external" id="val-toboolean"><a href="#val-toboolean" class="anchor"></a><code><span class="keyword">val</span> toboolean : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_toboolean">lua_toboolean</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-tocfunction"><a href="#val-tocfunction" class="anchor"></a><code><span class="keyword">val</span> tocfunction : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span><a href="index.html#type-oCamlFunction">oCamlFunction</a> option</span></code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_tocfunction">lua_tocfunction</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-toocamlfunction"><a href="#val-toocamlfunction" class="anchor"></a><code><span class="keyword">val</span> toocamlfunction : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span><a href="index.html#type-oCamlFunction">oCamlFunction</a> option</span></code></dt><dd><p>Alias of <a href="index.html#val-tocfunction"><code>Lua_api_lib.tocfunction</code></a></p></dd></dl><dl><dt class="spec value" id="val-tointeger"><a href="#val-tointeger" class="anchor"></a><code><span class="keyword">val</span> tointeger : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_tointeger">lua_tointeger</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-tolstring"><a href="#val-tolstring" class="anchor"></a><code><span class="keyword">val</span> tolstring : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_tolstring">lua_tolstring</a> documentation.</p><p><b>NOTE</b>: The original <code>len</code> argument is missing because, unlike in C, there is no impedance mismatch between OCaml and Lua strings</p></dd></dl><dl><dt class="spec value" id="val-tonumber"><a href="#val-tonumber" class="anchor"></a><code><span class="keyword">val</span> tonumber : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> float</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_tonumber">lua_tonumber</a> documentation.</p></dd></dl><aside><p>The function <a href="http://www.lua.org/manual/5.1/manual.html#lua_topointer">lua_topointer</a> is not available</p></aside><dl><dt class="spec value" id="val-tostring"><a href="#val-tostring" class="anchor"></a><code><span class="keyword">val</span> tostring : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p>Alias of <a href="index.html#val-tolstring"><code>Lua_api_lib.tolstring</code></a></p></dd></dl><dl><dt class="spec value" id="val-tothread"><a href="#val-tothread" class="anchor"></a><code><span class="keyword">val</span> tothread : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span><a href="index.html#type-state">state</a> option</span></code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_tothread">lua_tothread</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-touserdata"><a href="#val-touserdata" class="anchor"></a><code><span class="keyword">val</span> touserdata : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span><span>[&gt; <span>`Userdata of <span class="type-var">'a</span></span> <span><span>| `Light_userdata</span> of <span class="type-var">'a</span></span> ]</span> option</span></code></dt><dd><p>If the value at the given acceptable index is a full userdata, returns its value as <code>Some `Userdata v</code>. If the value is a light userdata, returns its value as <code>Some `Light_userdata v</code>. Otherwise, returns <code>None</code>.</p><p><b>WARNING</b>: using this function could be harmful because it actually breaks the type system. It has the same semantics of <code>Obj.magic</code>, allowing the programmer to push an OCaml value into the Lua state, and then retrieve it with a different type. Be very careful!</p></dd></dl><dl><dt class="spec value" id="val-type_"><a href="#val-type_" class="anchor"></a><code><span class="keyword">val</span> type_ : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-lua_type">lua_type</a></code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_type">lua_type</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-typename"><a href="#val-typename" class="anchor"></a><code><span class="keyword">val</span> typename : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-lua_type">lua_type</a> <span>&#45;&gt;</span> string</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_typename">lua_typename</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-xmove"><a href="#val-xmove" class="anchor"></a><code><span class="keyword">val</span> xmove : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_xmove">lua_xmove</a> documentation.</p></dd></dl><dl><dt class="spec value" id="val-yield"><a href="#val-yield" class="anchor"></a><code><span class="keyword">val</span> yield : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int</code></dt><dd><p>See <a href="http://www.lua.org/manual/5.1/manual.html#lua_yield">lua_yield</a> documentation.</p></dd></dl></section></div></body></html>